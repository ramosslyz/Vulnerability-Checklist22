# What is Rate Limiting?
  Rate limiting is used to control the amount of incoming and outgoing traffic to or from a network. If the number of requests you make exceeds that limit, then an error will be triggered. The reasoning behind implementing rate limits is to allow for a better flow of data and to increase security by mitigating attacks such as DDoS.
  
# What is No Rate Limiting Vulnerability?
  No rate limit means there is no mechanism to protect against requests you made in a short frame of time. So try to send lots of requests, if it is not blocking you then you can consider it as vulnerability.

# Why Password Reset Page?
  Most of the web application provides users â€œ password reset â€œ functionality via email. This functionality has given which allow users to recover their account, generate a new password, and repair their own problems. so letâ€™s start and learn how to look for bugs in this function.

# Before we jump into bypass, let's dig into places where we can find it.

* Login
* Reset Password
* 2FA/OTP
* Sign up
* Sending message
* Pin code
* Forums
* comments
* coupon codes

# The basic idea is just to find out how password reset token is generated:-

1. Generated based timestamp
2. Generated based on cryptography
3. Generated based on userID
4. Generated based on email user
5. Generated based on first name and last name
6. Generated based on the date of birth

# No rate limiting on password reset
  Rate limiting is used to control the amount of incoming and outgoing traffic to or from a network. Basically, no rate limit means there is no mechanism to protect against requests you made in a short frame of time. So try to send lots of requests, if it is not blocking you then you can consider it as vulnerability.

**How To Hunt:**

  1. Go to https://example.com/resetPassword/
  2. Enter the email then click reset password
  3. Intercept this request in burp suite
  4. Send it to the intruder and repeat it by 50 times
  5. You will get 200 OK status
  6. Reference link - https://hackerone.com/reports/838572

# No rate limit at signup page

**How To Hunt:**

1. Enter your details in signup form and submit the form
2. Capture the signup request and send it to intruder
3. add $$ to email parameter
4. In the payload add different email address
5. Fire up intruder and check whether it return 200 ok
6. Refferance link - https://hackerone.com/reports/905692

# Password Reset Link not expiring after changing the email
  when a user request changing password then he get a password reset link to reset the password, thatâ€™s the normal behaviour but it also should expire after some period of time. If it is not expiring and you can use the password reset link multiple times to reset the password. Then you can consider it as vulnerability.

**How To Hunt:**

  1. Send the password reset link to your email.
  2. Don`t open the password link just copy it and paste into any editor.
  3. Open your account.
  4. Go to your account settings.
  5. Under account, you will see Account Overview.
  6. Go to the Email and password Option and change the email and verify it.
  7. After changing the email go to your password reset link which you copied.
  8. Change your password.
  9. Reference link - https://hackerone.com/reports/685007

# Password Reset Link not expiring after changing password

**How To Hunt:**

  1. First You need to create an account with a Valid Email Address
  2. After Creating An Account log out from your Account and Navigate to Forgot Password Page
  3. Request a Password Reset Link for your Account
  4. Use The Password Reset Link And Change The Password, After Changing the Password Login to Your Account
  5. Now Use The Old Password Reset Link To Change The Password Again
  6. If You Are Able to Change Your Password Again Than This Is a Bug
  7. Reference link - https://hackerone.com/reports/898841

# Denial of service when entering a long password
  Normally passwords have 8â€“12â€“24 or up to 48 digits. if there is no word limit while keeping a password you can consider it as vulnerability. you can check when you setting the password while changing passwords or creating accounts as a long string which can lead to DOS.

**How to Hunt:**

  1. Go Sign up page and Forgot password page
  2. Fill the form and enter a long string in password
  3. Click on enter and youâ€™ll get 500 Internal Server error if it is vulnerable.
  4. Reference link - https://hackerone.com/reports/840598
  5. Reference link - https://hackerone.com/reports/738569

# Password reset token leak via referer

  The HTTP referrer is an optional HTTP header field that identifies the address of the webpage which is linked to the resource being requested. The Referer request-header contains the address of the previous web page from which a link to the currently requested page was followed. So it is possible that the password reset token is leaking via referrer request-header.

**How To Hunt:**

  1. Go to terget website and request for password reset
  2. Now check your email you will get your password reset link
  3. Now just copy the link and go to the private mode and paste the link
  4. Don't change the password before that click on any external links like social media links for avaliable one same website.
  5. Capture that request in burp suite.
  6. You will find reset token in referer header.
  7. Reference link - https://hackerone.com/reports/751581

# Password reset with manipulating email parameter
  while requesting a password reset link for the victim user, we can try the below parameter manipulation to get a copy of the reset link of the victim on the attacker email.

  **How To Hunt:**

1. Navigate to resetpassword function
2. Then, enter the victim's email address Intercept this request
3. Now, add your email also in the JSON body. like this {"email":["victim@gmail.com","your@gmail.com"]}
4. Forward this request
5. Now victim and you will receive the same password reset link
6. By using that link which you just received in your email
7. You can fully takeover the victim's account by reset password.
8. Refferance link - https://hackerone.com/reports/1175081

# Password reset Poisoining leads to token leak
  Password reset poisoning is a technique whereby an attacker manipulates a vulnerable website into generating a password reset link pointing to a domain under their control. This behaviour can be leveraged to steal the secret tokens required to reset arbitrary usersâ€™ passwords and, ultimately, compromise their accounts.
  
**How To Hunt:**

1. Intercept the password reset request in Burp Suite
2. Add or edit the following headers in Burp Suite : Host: attacker.com, X-Forwarded-Host: attacker.com
3. Forward the request with the modified header 
4. Look for a password reset URL based on the host header like : https://attacker.com/reset-password.php?token=TOKEN
5. Refferance link - https://hackerone.com/reports/226659

* X-Forwarded: bing.com
* X-Forwarded-By: bing.com
* X-Forwarded-For: bing.com
* X-Forwarded-For-Original: bing.com
* X-Forwarder-For: bing.com
* X-Forward-For: bing.com
* Forwarded-For: bing.com
* Forwarded-For-Ip: bing.com
* X-Custom-Ip-Authorization: bing.com
* X-Originating-Ip: bing.com
* X-Remote-Ip: bing.com
* X-Remote-Addr: bing.com

# Password Reset link hijacking via Host Header Poisoning leads to account takeover

**How To Hunt:**

1. Visit the forgot password page (https://example.com/forgot)
2. Enter the victim's email address and click on password reset link.
3. Intercept the HTTP request in Burp Suite & add the Host Header to your malicious site or server.
4. Forward the request and you'll be redirected to your server. 
5. The victim will then receive a password reset e-mail with your poisoned link. (https://ngrok.server/reset-password.php?token=12345678-1234-1234-1234-12345678901)
6. Refferance link - https://hackerone.com/reports/226659

# Rate Limit Bypass Techniques

**There are two ways to do that**

**1. Customizing HTTP Methods**

* If the request goes on GET try to change it to POST, PUT, etc.,
* If you wanna bypass the rate-limit in API's try HEAD method.

**2. Adding Headers to Spoof IP**

* X-Forwarded: 127.0.0.1
* X-Forwarded-By: 127.0.0.1
* X-Forwarded-For: 127.0.0.1
* X-Forwarded-For-Original: 127.0.0.1
* X-Forwarder-For: 127.0.0.1
* X-Forward-For: 127.0.0.1
* Forwarded-For: 127.0.0.1
* Forwarded-For-Ip: 127.0.0.1
* X-Custom-IP-Authorization: 127.0.0.1
* X-Originating-IP: 127.0.0.1
* X-Remote-IP: 127.0.0.1
* X-Remote-Addr: 127.0.0.1

# Bypass Rate Limit when thereâ€™s a CAPTCHA
  You must have encountered a Google CAPTCHA while testing Website. These are some ways with the help of which you can bypass it.

1. Try Removing CAPTCHA Parameter from the body of the Request.
2. Try adding some String of the same length as that of the Parameter.
3. Keep the Intercept ON, Send Request to Intruder. Sometimes, It may give unexpected results.

# Bypassing Rate Limit with some Characters

1. Adding Null Byte ( %00 ) at the end of the Email can sometimes Bypass Rate Limit.
2. Try adding a Space Character after a Email. ( Not Encoded )
3. Some Common Characters that help bypassing Rate Limit : %0d , %2e , %09 , %20

# How to mitigate No Rate Limiting ?

* Implement Captcha: Captcha is a common system to verify a human is a human on websites and can stop brute force attacks in progress
* Implement X-Rate-Limiting Header: We can set rate limiting with this header.

**Thanks For Reading ðŸ˜Š**

**Profile Links:**
* Youtube channel - https://www.youtube.com/@suresh_shankar/
* Linkedin - https://www.linkedin.com/in/bug-hunter-suresh/
